name: Ubuntu RDP
on: workflow_dispatch

jobs:
  desktop-access:
    runs-on: ubuntu-latest
    steps:
      - name: Connect to Tailscale
        uses: tailscale/github-action@v2
        with:
          authkey: ${{kgeUyryQDy11CNTRL}}

      - name: Install Desktop and RDP
        run: |
          sudo apt-get update
          # Install a lightweight desktop (XFCE) and XRDPServer
          sudo apt-get install -y xfce4 xfce4-goodies xrdp
          # Set a password for the 'runner' user
          echo "runner:YourSecurePassword123!" | sudo chpasswd
          # Allow RDP through the local firewall
          sudo adduser xrdp ssl-cert
          sudo systemctl restart xrdp
          echo "Ubuntu Desktop is ready!"

      - name: Keep Alive
        run: sleep 3600
          
